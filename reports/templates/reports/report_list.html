<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Liste des Signalements</title>
</head>
<body>
    <h1>Signalements en cours sur le Campus</h1>
    
    <div style="margin-bottom: 20px;">
        <a href="{% url 'reports:report_create' %}" style="padding: 10px; background: green; color: white; text-decoration: none; border-radius: 5px;">Signaler un nouveau problème</a>
    </div>

    <form method="get" style="margin-bottom: 30px; padding: 15px; background: #f4f4f4; border-radius: 8px;">
        <strong>Filtrer par catégorie :</strong>
        <select name="category">
            <option value="">Toutes les catégories</option>
            {% for code, name in categories %}
                <option value="{{ code }}">{{ name }}</option>
            {% endfor %}
        </select>
        <button type="submit">Appliquer</button>
        <a href="{% url 'reports:report_list' %}">Réinitialiser</a>
    </form>

    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
        {% for report in reports %}
            <div style="border: 1px solid #ccc; padding: 15px; border-radius: 8px; width: 300px; position: relative;">
                
                <div style="position: absolute; top: 10px; right: 10px; background: #eee; padding: 2px 8px; border-radius: 4px; font-size: 0.8em;">
                    {{ report.get_status_display }}
                </div>

                {% if report.image %}
                    <img src="{{ report.image.url }}" alt="{{ report.title }}" style="width: 100%; height: 150px; object-fit: cover; border-radius: 4px;">
                {% endif %}
                
                <h3>{{ report.title }}</h3>
                <p><strong>Catégorie :</strong> {{ report.get_category_display }}</p>
                <p>{{ report.description|truncatewords:15 }}</p>
                
                <hr>
                <p><small>Posté par <strong>{{ report.author }}</strong> le {{ report.created_at|date:"d/m/Y" }}</small></p>
                
                <a href="{% url 'reports:report_detail' report.pk %}">Voir les détails</a>
            </div>
        {% empty %}
            <p>Aucun signalement ne correspond à vos critères.</p>
        {% endfor %}
    </div>
</body>
</html>